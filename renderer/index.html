<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'"
    />
    <title>Bilzo Validation Portal</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="app-header">
        <h1>Bilzo Validation Portal</h1>
        <div class="sync-status">
          <span class="status-indicator" id="statusIndicator"></span>
          <span class="status-text" id="statusText">Checking...</span>
        </div>
      </header>

      <!-- Navigation Tabs -->
      <nav class="tab-navigation">
        <button class="tab-button active" data-tab="customer">Customer Lookup</button>
        <button class="tab-button" data-tab="coupon">Coupon Validation</button>
        <button class="tab-button" data-tab="loyalty">Loyalty Points</button>
        <button class="tab-button" data-tab="sync">Sync Status</button>
      </nav>

      <!-- Main Content -->
      <main class="app-content">
        <!-- Customer Lookup Tab -->
        <section class="tab-content active" id="customer-tab">
          <div class="form-group">
            <label for="customerMobile">Customer Mobile Number</label>
            <input
              type="tel"
              id="customerMobile"
              placeholder="Enter 10-digit mobile number"
              maxlength="10"
              pattern="[0-9]{10}"
            />
          </div>
          <button class="btn btn-primary" id="searchCustomer">Search Customer</button>

          <div class="result-container" id="customerResult" style="display: none">
            <h3>Customer Profile</h3>
            <div class="info-grid">
              <div class="info-item">
                <span class="label">Name:</span>
                <span class="value" id="custName">-</span>
              </div>
              <div class="info-item">
                <span class="label">Mobile:</span>
                <span class="value" id="custMobile">-</span>
              </div>
              <div class="info-item">
                <span class="label">Loyalty Points:</span>
                <span class="value highlight" id="custPoints">0</span>
              </div>
              <div class="info-item">
                <span class="label">Total Purchases:</span>
                <span class="value" id="custPurchases">0</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Coupon Validation Tab -->
        <section class="tab-content" id="coupon-tab">
          <div class="form-group">
            <label for="couponCode">Coupon Code</label>
            <input type="text" id="couponCode" placeholder="Enter coupon code" style="text-transform: uppercase" />
          </div>
          <div class="form-group">
            <label for="couponMobile">Customer Mobile</label>
            <input type="tel" id="couponMobile" placeholder="Enter mobile number" maxlength="10" />
          </div>
          <div class="form-group">
            <label for="purchaseAmount">Purchase Amount</label>
            <input type="number" id="purchaseAmount" placeholder="Enter purchase amount" />
          </div>
          <button class="btn btn-primary" id="validateCoupon">Validate Coupon</button>

          <div class="result-container" id="couponResult" style="display: none">
            <!-- Results populated by JS -->
          </div>

          <!-- Button to send OTP, hidden by default -->
          <button class="btn btn-secondary" id="sendOtpCoupon" style="display: none; margin-top: 10px;">Send OTP</button>

          <!-- Coupon Redemption Section -->
          <div class="coupon-redemption-container" id="couponRedemptionContainer" style="margin-top: 20px;">
            <!-- OTP validation placeholder and button, both hidden initially -->
            <div class="form-group" id="otpValidationGroup" style="display: none;">
              <label for="couponOtp">Enter OTP</label>
              <input type="text" id="couponOtp" placeholder="Enter OTP" maxlength="6" autocomplete="one-time-code" />
              <button class="btn btn-primary" id="validateCouponOtp" style="margin-top: 20px;">Validate OTP</button>
            </div>
            <!-- Redeem Coupon Button -->
             <div style="display: none;" id="redeemCouponGroup">
              <div class="form-group">
                <label for="receiptNo">Enter Receipt No</label>
                <input type="text" id="receiptNo" placeholder="Enter Receipt No"  />
              </div>
              <button class="btn btn-primary" id="redeemCouponBtn">Redeem Coupon</button>
             </div>
          </div>
        </section>

        <!-- Loyalty Points Tab -->
        <section class="tab-content" id="loyalty-tab">
          <div class="form-group">
            <label for="loyaltyMobile">Customer Mobile Number</label>
            <input type="tel" id="loyaltyMobile" placeholder="Enter 10-digit mobile number" maxlength="10" />
            <label for="billAmount">Bill Amount</label>
            <input id="billAmount" placeholder="Enter bill amount" />
          </div>
          <button class="btn btn-primary" id="checkLoyalty">Check Loyalty Points</button>

          <div class="result-container" id="loyaltyResult" style="display: none">
            <h3>Loyalty Information</h3>
            <div class="loyalty-display">
              <div class="points-badge">
                <span class="points-value" id="loyaltyPoints">0</span>
                <span class="points-label">Available Points</span>
              </div>
            </div>
          </div>
          <div class="redemption-container" id="loyaltyRedeem" style="display: none">
            <h3>Redeem Points</h3>
            <div class="form-group">
              <label for="receiptNo">Bill No.</label>
              <input id="receiptNo" placeholder="Enter receipt number" />
              <label for="loyaltyPoints">Points to redeem</label>
              <input id="loyalPoints" placeholder="Enter loyalty points for redemption" />
            </div>
            <button class="btn btn-primary" id="loyaltyRedemption">Redeem Points</button>
          </div>
        </section>

        <!-- Sync Status Tab -->
        <section class="tab-content" id="sync-tab">
          <div class="sync-controls">
            <button class="btn btn-secondary" id="refreshSync">Refresh Stats</button>
            <button class="btn btn-primary" id="forceSyncNow">Sync Now</button>
          </div>

          <div class="result-container">
            <h3>Sync Statistics</h3>
            <div class="info-grid">
              <div class="info-item">
                <span class="label">Status:</span>
                <span class="value" id="syncStatusText">-</span>
              </div>
              <div class="info-item">
                <span class="label">Last Sync:</span>
                <span class="value" id="lastSyncTime">Never</span>
              </div>
              <div class="info-item">
                <span class="label">Total Synced:</span>
                <span class="value highlight" id="totalSynced">0</span>
              </div>
              <div class="info-item">
                <span class="label">Failed:</span>
                <span class="value error" id="totalFailed">0</span>
              </div>
              <div class="info-item">
                <span class="label">Last Sync Receipt:</span>
                <span class="value" id="lastSyncedReceiptNo">-</span>
              </div>
              <div class="info-item">
                <span class="label">Last Receipt on Server:</span>
                <span class="value" id="lastReceiptOnServer">-</span>
              </div>
              <div class="info-item">
                <span class="label">SQL Connection:</span>
                <span class="value" id="sqlStatus">-</span>
              </div>
            </div>
          </div>

          <div class="result-container" style="margin-top: 20px;">
            <h3>App Settings</h3>
            <div class="info-grid">
              <div class="info-item">
                <span class="label">Auto-start on Boot:</span>
                <span class="value" id="autoStartStatus">Checking...</span>
              </div>
            </div>
            <div class="update-controls" style="margin-top: 15px;">
              <button class="btn btn-secondary" id="toggleAutoStart">Enable Auto-start</button>
            </div>
          </div>

          <div class="result-container" style="margin-top: 20px;">
            <h3>App Updates</h3>
            <div class="info-grid">
              <div class="info-item">
                <span class="label">Current Version:</span>
                <span class="value" id="currentVersion">-</span>
              </div>
              <div class="info-item">
                <span class="label">Update Status:</span>
                <span class="value" id="updateStatusText">Checking...</span>
              </div>
            </div>
            <div class="update-controls" style="margin-top: 15px;">
              <button class="btn btn-secondary" id="checkForUpdates">Check for Updates</button>
              <button class="btn btn-primary" id="downloadUpdate" style="display: none;">Download Update</button>
              <button class="btn btn-primary" id="installUpdate" style="display: none;">Restart & Install</button>
            </div>
            <div id="updateProgress" style="display: none; margin-top: 10px;">
              <div class="progress-bar">
                <div class="progress-fill" id="updateProgressFill" style="width: 0%;"></div>
              </div>
              <div style="text-align: center; margin-top: 5px; font-size: 0.9em; color: #666;" id="updateProgressText">0%</div>
            </div>
          </div>
        </section>

        <!-- Error/Success Messages -->
        <div class="message-container" id="messageContainer"></div>
      </main>
    </div>

    <script src="app.js"></script>
  </body>
</html>
